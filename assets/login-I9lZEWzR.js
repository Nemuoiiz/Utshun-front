import{ak as _,al as k,a2 as y,ar as B,S as F,U as N,a3 as r,L as s,Z as c,aO as U,a6 as a,aN as d,am as A,a5 as C}from"./index-C1Wq3k6J.js";import{c as M,a as p,u as q,e as f}from"./index.esm-DLt04wSt.js";import{v as P}from"./index-DV14HKND.js";import{V as R,a as V,b as g}from"./route-block-CQ7mDXys.js";import{V as T}from"./VDivider-BkKwZ4LZ.js";import{V as $}from"./VForm-Ca6y0Dak.js";import{V as j}from"./VContainer-fQhPXwuc.js";const D={class:"text-center"},L={__name:"login",setup(O){const{api:b}=B(),i=_(),v=k(),x=y(),w=M({account:p().required("帳號必填").min(4,"帳號長度不足").max(20,"帳號長度超出限制").test("isAlphanumeric","帳號格式不符",l=>P.isAlphanumeric(l)),password:p().required("密碼必填").min(4,"密碼長度不足").max(20,"密碼長度超出限制")}),{handleSubmit:h,isSubmitting:m}=q({validationSchema:w}),n=f("account"),u=f("password"),S=h(async l=>{var e,o;try{const{data:t}=await b.post("/user/login",{account:l.account,password:l.password});x.login(t.result),i({text:"登入成功",snackbarProps:{color:"green"}}),v.push("/")}catch(t){console.log(t),i({text:((o=(e=t==null?void 0:t.response)==null?void 0:e.data)==null?void 0:o.message)||"發生未知錯誤",snackbarProps:{color:"red"}})}});return(l,e)=>(N(),F(j,null,{default:r(()=>[s(R,{justify:"center"},{default:r(()=>[s(V,{cols:"12"},{default:r(()=>e[2]||(e[2]=[c("h1",{class:"text-center"},"登入帳號",-1)])),_:1}),s(T),s(V,{cols:"6"},{default:r(()=>[s($,{disabled:a(m),onSubmit:U(a(S),["prevent"])},{default:r(()=>[s(d,{modelValue:a(n).value.value,"onUpdate:modelValue":e[0]||(e[0]=o=>a(n).value.value=o),"error-messages":a(n).errorMessage.value,label:"帳號",minlength:"4",maxlength:"20",counter:""},null,8,["modelValue","error-messages"]),s(d,{modelValue:a(u).value.value,"onUpdate:modelValue":e[1]||(e[1]=o=>a(u).value.value=o),type:"password","error-messages":a(u).errorMessage.value,label:"密碼",minlength:"4",maxlength:"20",counter:""},null,8,["modelValue","error-messages"]),c("div",D,[s(A,{loading:a(m),type:"submit",color:"primary"},{default:r(()=>e[3]||(e[3]=[C("登入")])),_:1},8,["loading"])])]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1})]),_:1}))}};typeof g=="function"&&g(L);export{L as default};
